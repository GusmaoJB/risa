% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hra.R
\name{hra}
\alias{hra}
\title{Habitat Risk Assessment (HRA)}
\usage{
hra(
  raster_list,
  species_distr,
  criteria,
  equation = c("euclidean", "multiplicative"),
  r_max = 3,
  n_overlap = NULL,
  output_decimal_crs = FALSE
)
}
\arguments{
\item{raster_list}{list}

\item{species_distr}{SpatRaster (single) OR named list of SpatRasters (ecosystem).
If an element is a list, the first SpatRaster within it will be used.}

\item{criteria}{data.frame (single) OR named list of data.frames (ecosystem).}

\item{equation}{c("euclidean","multiplicative")}

\item{r_max}{integer in 1..10}

\item{n_overlap}{optional number of stressors (default inferred)}

\item{output_decimal_crs}{logical; reproject outputs to EPSG:4326 if TRUE}
}
\value{
"risaHRA" list with per-stressor maps, totals, and summary_stats
}
\description{
Implements the Natural Capital Project’s InVEST Habitat Risk Assessment (HRA)
model to estimate spatial risk from multiple stressors to a species/habitat
(single-species mode) or across multiple species (ecosystem mode). For each
stressor, the function combines Exposure (E) and Consequence (C) criteria—
mixing mapped rasters and constant scores—using either the Euclidean or
Multiplicative InVEST risk equations. Inputs can be nested lists of rasters
(stressor → attributes; or species → stressor → attributes) plus a species
distribution raster (or list) and a criteria table (or list). Rasters are
auto-aligned to the species grid; outputs include per-stressor E/C maps,
raw and classed risk maps, ecosystem risk (when applicable), and a
`summary_stats` data frame. Optional reprojection to EPSG:4326 is supported.
}
\examples{
# example code

# Creating test data
set.seed(12)
spp_df <- rbind(data.frame(long = rnorm(80, 0, 10),
lat = rnorm(80, 0, 10), species = "species1"),
data.frame(long = rnorm(60, 0, 10),
lat = rnorm(60, 0, 10), species = "species2"))
str_df <- rbind(data.frame(long = rnorm(100, 0, 5),
lat = rnorm(100, 0, 10), stressor = "stressor1"),
data.frame(long = rnorm(50, 0, 10),
lat = rnorm(100, 0, 5), stressor = "stressor2"))
# Create kernel maps of species and stressor distributions and overlap maps
risa_maps <- risa_prep(spp_df, str_df)
#Load example data
path <- system.file("extdata", "multi_species_criteria.csv", package = "risa")
df <- read.csv(path)
#Reshape criteria table
crit_list <- criteria_reshape(df)
# Selecting spatially explicit criteria ratings
# Note that the rasters in the stressors's list are named after the respective attribute in the criteria table.
rast_list <- list(
species1 = list(
stressor1 = list(
intensity = risa_maps$stressor_kernel_maps$stressor1$raster,
`likelihood of interaction`=risa_maps$overlap_maps$species1$stressor1$raster),
stressor2 = list(
intensity = risa_maps$stressor_kernel_maps$stressor2$raster,
`likelihood of interaction`=risa_maps$overlap_maps$species1$stressor2$raster)
),
species2 = list(
stressor1 = list(
intensity = risa_maps$stressor_kernel_maps$stressor1$raster,
`likelihood of interaction`=risa_maps$overlap_maps$species2$stressor1$raster),
stressor2 = list(
intensity = risa_maps$stressor_kernel_maps$stressor2$raster,
`likelihood of interaction`=risa_maps$overlap_maps$species2$stressor2$raster)
)
)

# Species' distributions rasters
spp_dist <- list(species1 = risa_maps$species_distributions$species1$raster,
species2 = risa_maps$species_distributions$species2$raster)

# Simple example with one species and one stressor
test1 <- hra(rast_list[[1]], spp_dist[[1]], crit_list[[1]], equation = "euclidean")
terra::plot(test1$total_raw)
test1$summary_stats

# Now with two species and two stressors
many_test <- hra(rast_list, spp_dist, crit_list, equation = "euclidean")
many_test$summary_stats
terra::plot(many_test$species1$total_raw)
terra::plot(many_test$species2$total_raw)
}
\references{
Arkema KK, Verutes G, Bernhardt JR, Clarke C, Rosado S, Canto M, et al. (2014)
Assessing habitat risk from human activities to inform coastal and marine spatial
planning: a demonstration in Belize. \emph{Environmental Research Letters} 9:114016.

Sharp R, Tallis H, Ricketts T, Guerry A, Wood SA, Chaplin-Kramer R, et al. (2016)
InVEST [Internet]. The Natural Capital Project, Stanford University, University of
Minnesota, The Nature Conservancy, and World Wildlife Fund. Available at
\url{http://www.naturalcapitalproject.org/software/}.

Chung MG, Kang H, Choi S-U. (2015) Assessment of Coastal Ecosystem Services for
Conservation Strategies in South Korea. \emph{PLOS ONE} 10:e0133856. PMID: 26221950.
}
